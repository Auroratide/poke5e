import{S as X,i as Y,s as Z,f as _,d as S,t as T,a as E,m as L,g as C,c as K,w as h,b as R,y as w,u as ee,k as d,M as te,l as N,U as ne,n as k,z as x,o as j,q as y,p as G,r as Q,j as re}from"../chunks/DxXr5LT4.js";import"../chunks/BxlXVsHr.js";/* empty css                */import{C as ae}from"../chunks/DV5dzWo1.js";import"../chunks/CfLLFfri.js";import"../chunks/BhQ5dr_1.js";import{C as oe}from"../chunks/BZeu6lwb.js";import{B as se}from"../chunks/CDaknabi.js";import{P as le}from"../chunks/BshtTGA6.js";import{T as ce}from"../chunks/s81-ahmI.js";import{F as V}from"../chunks/DpUmkZHt.js";import{T as U}from"../chunks/qn5y3u3q.js";async function ie(){const o=U.getReadKeys().map(t=>({readKey:t,writeKey:U.getWriteKey(t)})),n={fakemon:V.list(),trainers:o};return new Blob([JSON.stringify(n)],{type:"application/json"})}class fe extends Error{constructor(e){super(e)}}async function ue(o){try{const e=await o.text(),n=JSON.parse(e);Array.isArray(n.fakemon)&&n.fakemon.map(t=>{V.add(t)}),Array.isArray(n.trainers)&&n.trainers.map(t=>{U.addReadKey(t.readKey),t.writeKey&&U.addWriteKey(t.readKey,t.writeKey)})}catch(e){throw console.error(e),new fe("Failed to restore backup: File was not formatted correctly.")}}const J={create:ie,restore:ue};function pe(o){let e;return{c(){e=Q("Download Backup File")},l(n){e=G(n,"Download Backup File")},m(n,t){C(n,e,t)},d(n){n&&_(e)}}}function W(o){let e,n="Backup is restored!";return{c(){e=y("p"),e.textContent=n},l(t){e=k(t,"P",{"data-svelte-h":!0}),x(e)!=="svelte-15qxlgn"&&(e.textContent=n)},m(t,a){C(t,e,a)},d(t){t&&_(e)}}}function z(o){let e,n,t="Error:",a,r;return{c(){e=y("p"),n=y("strong"),n.textContent=t,a=w(),r=Q(o[1])},l(c){e=k(c,"P",{});var l=j(e);n=k(l,"STRONG",{"data-svelte-h":!0}),x(n)!=="svelte-1s1dywc"&&(n.textContent=t),a=h(l),r=G(l,o[1]),l.forEach(_)},m(c,l){C(c,e,l),d(e,n),d(e,a),d(e,r)},p(c,l){l&2&&re(r,c[1])},d(c){c&&_(e)}}}function me(o){let e,n="<p>This is a work in progress.</p>",t,a,r,c="Save Backup",l,u,g,i,B,D="Restore Backup",I,v,H="Upload Backup File",P,b,q,O,F,A,M;u=new se({props:{$$slots:{default:[pe]},$$scope:{ctx:o}}}),u.$on("click",o[2]);let p=o[0]&&W(),f=o[1]&&z(o);return{c(){e=y("section"),e.innerHTML=n,t=w(),a=y("section"),r=y("h2"),r.textContent=c,l=w(),R(u.$$.fragment),g=w(),i=y("section"),B=y("h2"),B.textContent=D,I=w(),v=y("label"),v.textContent=H,P=w(),b=y("input"),q=w(),p&&p.c(),O=w(),f&&f.c(),this.h()},l(s){e=k(s,"SECTION",{"data-svelte-h":!0}),x(e)!=="svelte-1iquu2g"&&(e.innerHTML=n),t=h(s),a=k(s,"SECTION",{});var m=j(a);r=k(m,"H2",{"data-svelte-h":!0}),x(r)!=="svelte-14evq85"&&(r.textContent=c),l=h(m),K(u.$$.fragment,m),m.forEach(_),g=h(s),i=k(s,"SECTION",{});var $=j(i);B=k($,"H2",{"data-svelte-h":!0}),x(B)!=="svelte-l1lut6"&&(B.textContent=D),I=h($),v=k($,"LABEL",{for:!0,"data-svelte-h":!0}),x(v)!=="svelte-pbvc2w"&&(v.textContent=H),P=h($),b=k($,"INPUT",{id:!0,type:!0,accept:!0}),q=h($),p&&p.l($),O=h($),f&&f.l($),$.forEach(_),this.h()},h(){N(v,"for","restore-backup"),N(b,"id","restore-backup"),N(b,"type","file"),N(b,"accept",".poke5e"),ne(i,"margin-block-end","1em")},m(s,m){C(s,e,m),C(s,t,m),C(s,a,m),d(a,r),d(a,l),L(u,a,null),C(s,g,m),C(s,i,m),d(i,B),d(i,I),d(i,v),d(i,P),d(i,b),d(i,q),p&&p.m(i,null),d(i,O),f&&f.m(i,null),F=!0,A||(M=te(b,"change",o[3]),A=!0)},p(s,m){const $={};m&16&&($.$$scope={dirty:m,ctx:s}),u.$set($),s[0]?p||(p=W(),p.c(),p.m(i,O)):p&&(p.d(1),p=null),s[1]?f?f.p(s,m):(f=z(s),f.c(),f.m(i,null)):f&&(f.d(1),f=null)},i(s){F||(E(u.$$.fragment,s),F=!0)},o(s){T(u.$$.fragment,s),F=!1},d(s){s&&(_(e),_(t),_(a),_(g),_(i)),S(u),p&&p.d(),f&&f.d(),A=!1,M()}}}function $e(o){let e,n;return e=new ae({props:{title:"Backups",$$slots:{default:[me]},$$scope:{ctx:o}}}),{c(){R(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,a){L(e,t,a),n=!0},p(t,a){const r={};a&19&&(r.$$scope={dirty:a,ctx:t}),e.$set(r)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){S(e,t)}}}function de(o){let e,n;return e=new oe({props:{slot:"icon"}}),{c(){R(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,a){L(e,t,a),n=!0},p:ee,i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){S(e,t)}}}function _e(o){let e,n,t,a;return e=new ce({props:{value:"Backups"}}),t=new le({props:{theme:"grey",$$slots:{icon:[de],default:[$e]},$$scope:{ctx:o}}}),{c(){R(e.$$.fragment),n=w(),R(t.$$.fragment)},l(r){K(e.$$.fragment,r),n=h(r),K(t.$$.fragment,r)},m(r,c){L(e,r,c),C(r,n,c),L(t,r,c),a=!0},p(r,[c]){const l={};c&19&&(l.$$scope={dirty:c,ctx:r}),t.$set(l)},i(r){a||(E(e.$$.fragment,r),E(t.$$.fragment,r),a=!0)},o(r){T(e.$$.fragment,r),T(t.$$.fragment,r),a=!1},d(r){r&&_(n),S(e,r),S(t,r)}}}function ge(o,e,n){const t=async()=>{const l=await J.create(),u=URL.createObjectURL(l),g=document.createElement("a");g.href=u,g.download=`backup-${new Date().toISOString()}.poke5e`,g.click(),URL.revokeObjectURL(u)};let a=!1,r;return[a,r,t,async l=>{const u=l.target.files[0];if(u)try{await J.restore(u),n(0,a=!0)}catch(g){n(1,r=g.message)}}]}class Le extends X{constructor(e){super(),Y(this,e,ge,_e,Z,{})}}export{Le as component};
