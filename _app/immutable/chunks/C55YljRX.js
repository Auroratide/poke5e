var g=Object.defineProperty;var p=(i,t,e)=>t in i?g(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var h=(i,t,e)=>p(i,typeof t!="symbol"?t+"":t,e);import{D as d}from"./Bf-g66YD.js";class f extends d{get contest(){return this.data.contest}get appeal(){return this.data.appeal}get jam(){return this.data.jam}get effect(){return this.data.effect}}class b extends d{get scope(){return this.data.scope}toHit(t,e){return t+e}}class v extends d{damage(t,e,a,r){let s=0;const n=this.data.modifier;if(typeof n=="number")s=n;else{const o=n.match(/MOVE(\s*\+\s*(\d+))?/i);n==="LEVEL"?s=a.data:o&&(s=t+(e?this.stab(a,t,r):0),s+=parseInt(o[2]??"0"))}return{dice:this.getDamageDice(a.data),mod:s,isHealing:this.data.type==="healing"}}stab(t,e,a){return a==="2018"?Math.floor((t.data+1)/4):Math.max(e,0)}getDamageDice(t){const a=Object.keys(this.data.dice).map(Number).filter(s=>s<=t),r=Math.max(...a);return this.data.dice[r]}}class w extends d{appliesToAttribute(t){return typeof this.data=="string"?this.data==="any"||this.data==="varies":this.data.includes(t)}attributeList(){return this.data==="none"||this.data==="varies"?[]:this.data==="any"?["str","dex","con","int","wis","cha"]:this.data}bestAttribute(t){let e=[],a=0;for(const r of this.attributeList()){const s=t[r].score;s===a?e.push(r):s>a&&(a=s,e=[r])}return e}toString(){return typeof this.data=="string"?this.data:this.data.join(", ")}}class y extends d{withDc(t,e){return{attribute:this.data.attribute,dc:8+t+e}}}class l extends d{get id(){return this.data.id}get cost(){return this.data.cost}}h(l,"byTmId",(t,e)=>t.tm.id-e.tm.id);class L extends d{get id(){return this.data.id}get beta(){return this.data.beta??!1}get name(){return this.data.name}get type(){return this.data.type}get power(){return new w(this.data.power)}get time(){return this.data.time}get pp(){return this.data.pp}get duration(){return this.data.duration}get range(){return this.data.range}get description(){return this.data.description}get higherLevels(){return this.data.higherLevels}get optional(){return this.data.optional}get contest(){return this.data.contest?new f(this.data.contest):void 0}get tm(){return this.data.tm?new l(this.data.tm):void 0}get damage(){return this.data.damage?new v(this.data.damage):void 0}get attack(){return this.data.attack?new b(this.data.attack):void 0}get save(){return this.data.save?new y(this.data.save):void 0}tmName(){return this.tm==null?this.name:`${this.tm.id} - ${this.name}`}isTm(){return this.tm!=null}pokemonWhoLearnThis(t){return t.filter(e=>e.moves.canLearn(this))}pokemonWhoLearnThisViaTm(t){return t.filter(e=>e.moves.canLearnViaTm(this))}calculateMoveStats(t,e){var u,c,m;const a={};if(this.power.data==="none"||this.power.data==="varies")return a;const r=this.power.bestAttribute(e.attributes)[0];if(r==null)return a;const s=e.attributes[r].modifier,n=e.level.proficiencyBonus,o=e.type.includes(this.type);return a.toHit=(u=this.attack)==null?void 0:u.toHit(n,s),a.save=(c=this.save)==null?void 0:c.withDc(n,s),a.damage=(m=this.damage)==null?void 0:m.damage(s,o,e.level,t),a}}h(L,"matchNameOrType",t=>e=>e.name.toLocaleLowerCase().includes(t.toLocaleLowerCase())||e.type.includes(t.toLocaleLowerCase()));export{L as M,l as T};
