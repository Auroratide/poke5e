var Z=Object.defineProperty;var ee=(t,e,i)=>e in t?Z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var o=(t,e,i)=>ee(t,typeof e!="symbol"?e+"":e,i);import{b as E}from"./CYtsQYjJ.js";import{r as L,w as N,d as x}from"./D5JUfc2g.js";import{D as l}from"./Bf-g66YD.js";import"./IHki7fMi.js";import"./CxfxKJMp.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        */import"./CdRAs_Ty.js";/* empty css        *//* empty css        */import"./BCMjZdp6.js";import{P as W}from"./DLn0St_8.js";import{e as te,P as ie,s as se}from"./BzBZiFu4.js";/* empty css        */import"./WOuzEWXl.js";/* empty css        *//* empty css        *//* empty css        */class u extends l{isFakemon(){return this.data.startsWith("F.")}toFakemonReadKey(){if(!this.isFakemon())throw new Error("Attempted to convert non-fakemon species identifier into a fakemon read key.");return this.data.substring(2)}static fromSpeciesName(e){return new u(e)}static fromFakemonReadKey(e){return new u(`F.${e}`)}}class J extends l{constructor(){super(...arguments);o(this,"score",i=>({score:i,modifier:Math.floor(i/2)-5}))}get str(){return this.score(this.data.str)}get dex(){return this.score(this.data.dex)}get con(){return this.score(this.data.con)}get int(){return this.score(this.data.int)}get wis(){return this.score(this.data.wis)}get cha(){return this.score(this.data.cha)}}o(J,"list",[{abbr:"str",name:"Strength"},{abbr:"dex",name:"Dexterity"},{abbr:"con",name:"Constitution"},{abbr:"int",name:"Intelligence"},{abbr:"wis",name:"Wisdom"},{abbr:"cha",name:"Charisma"}]);const ae={Tiny:"tiny",Small:"small",Medium:"medium",Large:"large",Huge:"huge",Gargantuan:"gargantuan"};function re(t){return Object.values(ae).includes(t)}class _ extends l{constructor(){super(...arguments);o(this,"mergeWith",i=>{const s=Object.fromEntries(Object.entries(i.data).filter(([,r])=>r!=null)),a={...this.data,...s};return new this.constructor(a)})}static fromList(i,s){return new i(s.reduce((a,r)=>({...a,[r.type]:r.value}),{}))}}const O=["d4","d6","d8","d10","d12","d20"];class A extends l{constructor(){super(...arguments);o(this,"sizeAsInt",()=>parseInt(this.data.slice(1)))}static isHitDice(i){return O.includes(i)}}o(A,"list",O);class P extends _{}o(P,"types",{Walking:"walking",Climbing:"climbing",Swimming:"swimming",Flying:"flying",Hover:"hover",Burrowing:"burrowing"});class K extends _{}o(K,"types",{Darkvision:"darkvision",Blindsight:"blindsight",Tremorsense:"tremorsense",Truesight:"truesight"});const m=class m extends l{constructor(){super(...arguments);o(this,"toList",()=>Object.entries(this.data).filter(([,i])=>i>0).map(i=>i[0]));o(this,"addProficiencies",i=>{for(const s of i)this.data[s]===0&&(this.data[s]=1);return this});o(this,"isProficient",i=>this.data[i]>0);o(this,"isExpert",i=>this.data[i]>1);o(this,"modifier",(i,s,a)=>{const r=m.list.find(n=>n.name===i).attribute;return s[r].modifier+a.proficiencyBonus})}static fromList(i){return new m(m.list.reduce((s,a)=>({...s,[a.name]:i.includes(a.name)?1:0}),{}))}};o(m,"list",[{name:"athletics",attribute:"str"},{name:"acrobatics",attribute:"dex"},{name:"sleight of hand",attribute:"dex"},{name:"stealth",attribute:"dex"},{name:"arcana",attribute:"int"},{name:"history",attribute:"int"},{name:"investigation",attribute:"int"},{name:"nature",attribute:"int"},{name:"religion",attribute:"int"},{name:"animal handling",attribute:"wis"},{name:"insight",attribute:"wis"},{name:"medicine",attribute:"wis"},{name:"perception",attribute:"wis"},{name:"survival",attribute:"wis"},{name:"deception",attribute:"cha"},{name:"intimidation",attribute:"cha"},{name:"performance",attribute:"cha"},{name:"persuasion",attribute:"cha"}]);let f=m;class y extends l{toList(){return this.data.normal.map(e=>({id:e,hidden:!1})).concat(this.data.hidden.map(e=>({id:e,hidden:!0})))}findApplicableAbility(e){const i=this.data.normal,s=this.data.hidden,a=e.normal>=0?i[Math.min(i.length-1,e.normal)]:void 0,r=e.hidden>=0?s[Math.min(s.length-1,e.hidden)]:void 0;if(e.hidden>=0&&r==null){const n=i[i.length-1];return n?{id:n,hidden:!1}:void 0}return a?{id:a,hidden:!1}:r?{id:r,hidden:!0}:void 0}findIndex(e){const i=this.data.normal.indexOf(e),s=this.data.hidden.indexOf(e);return{exists:i>=0||s>=0,normal:i,hidden:s}}isEmpty(){return this.data.normal.length===0&&this.data.hidden.length===0}static fromList(e){return new y({normal:e.filter(i=>!i.hidden).map(i=>i.id),hidden:e.filter(i=>i.hidden).map(i=>i.id)})}static groupSpeciesByAbility(e,i){if(e==null||i==null||(e==null?void 0:e.length)===0||(i==null?void 0:i.length)===0)return{};const s=a=>r=>r.abilities.findIndex(a).exists;return e.reduce((a,r)=>({...a,[r]:i.filter(s(r))}),{})}}const nt=L(void 0,t=>{typeof window<"u"&&fetch(`${E}/abilities.json`).then(e=>e.json()).then(e=>t(e.abilities))}),ne=["monster","human-like","water 1","water 2","water 3","bug","mineral","flying","amorphous","fairy","ditto","dragon","field","grass","gender unknown","undiscovered"];class q extends l{constructor(){super(...arguments);o(this,"isExclusive",()=>this.data.length===1);o(this,"map",i=>this.data.map(i));o(this,"toString",()=>this.data.join(", "))}static groupBy(i){const s=new Map;for(const a of i)a.eggGroups.map(r=>{s.has(r)||s.set(r,{exclusive:[],shares:[]}),a.eggGroups.isExclusive()?s.get(r).exclusive.push(a):s.get(r).shares.push(a)});return s}}o(q,"standardList",ne);class oe extends l{constructor(){super(...arguments);o(this,"isGenderless",()=>{const[i,s]=this.ratio();return i+s===0});o(this,"percentFemale",()=>this.percentOf(0));o(this,"percentMale",()=>this.percentOf(1));o(this,"ratio",()=>this.data.split(":").map(i=>parseInt(i)));o(this,"percentOf",i=>{if(this.isGenderless())return 0;const s=this.ratio();return de(100*s[i]/(s[0]+s[1]))})}}const de=t=>t<50?Math.ceil(t):Math.floor(t),p=class p extends l{portrait({shiny:e=!1}={}){return e&&this.data.values.shinyPortrait!==void 0?{value:this.data.values.shinyPortrait,hueRotate:0}:e&&this.data.values.shinyPortrait===void 0?{value:this.data.values.normalPortrait,hueRotate:this.customization.shinyHue}:{value:this.data.values.normalPortrait,hueRotate:0}}sprite({shiny:e=!1}={}){return e&&this.data.values.shinySprite!==void 0?{value:this.data.values.shinySprite,hueRotate:0,portraitFallback:!1}:this.data.values.normalSprite!==void 0?{value:this.data.values.normalSprite,hueRotate:e?this.customization.shinyHue:0,portraitFallback:!1}:e&&this.data.values.shinyPortrait!==void 0?{value:this.data.values.shinyPortrait,hueRotate:0,portraitFallback:!0}:{value:this.data.values.normalPortrait,hueRotate:e?this.customization.shinyHue:0,portraitFallback:!0}}hasAnyMedia(){return Object.values(this.data.values).some(e=>e!=null)}get customization(){return this.data.customization??{shinyHue:0}}static forEachType(e){return new p({values:p.types.reduce((i,s)=>({...i,[s]:e(s)}),{})})}};o(p,"types",["normalPortrait","normalSprite","shinyPortrait","shinySprite"]),o(p,"attributionTypes",[{name:"Human Drawn",value:"human"},{name:"AI Generated",value:"ai"},{name:"Other",value:"other"}]);let c=p;class le extends l{}class ue extends l{constructor(){super(...arguments);o(this,"toString",()=>this.data<=.125?"⅛":this.data<=.25?"¼":this.data<=.5?"½":Math.round(this.data).toString())}}class S extends l{get id(){return new u(this.data.id)}get name(){return this.data.name}get type(){return new W(this.data.type)}get gender(){return new oe(this.data.gender)}get sr(){return new ue(this.data.sr)}get eggGroups(){return new q(this.data.eggGroups)}get hitDice(){return new A(this.data.hitDice)}get speed(){return new P(this.data.speed)}get senses(){return new K(this.data.senses)}get attributes(){return new J(this.data.attributes)}get skills(){return new f(this.data.skills)}get media(){return new c(this.data.media)}get moves(){return new le(this.data.moves)}get abilities(){return new y(this.data.abilities)}numberAsString(){return`#${this.data.number.toString().padStart(4,"0")}`}static fromJson(e){return new S({id:u.fromSpeciesName(e.id).data,name:e.name,number:e.number,type:e.type,size:e.size,sr:e.sr,minLevel:e.minLevel,eggGroups:e.eggGroup,gender:e.gender,description:e.description,ac:e.ac,hp:e.hp,hitDice:e.hitDice,speed:_.fromList(P,e.speed).data,senses:_.fromList(K,e.senses).data,attributes:e.attributes,skills:f.fromList(e.skills).data,saves:e.savingThrows,abilities:y.fromList(e.abilities).data,moves:e.moves,media:{values:{normalPortrait:{name:e.media.main,href:e.media.main},normalSprite:e.media.sprite?{name:e.media.sprite,href:e.media.sprite}:void 0,shinyPortrait:e.media.mainShiny?{name:e.media.mainShiny,href:e.media.mainShiny}:void 0,shinySprite:e.media.spriteShiny?{name:e.media.spriteShiny,href:e.media.spriteShiny}:void 0},customization:{shinyHue:0},attribution:e.media.attribution?{href:e.media.attribution,portrait:{type:"other",name:"",href:""},sprite:{type:"other",name:"",href:""}}:void 0}})}}class ce{constructor(e,i){o(this,"info",async(e,i)=>{try{if(i.media!=null){const s=await this.provider.updateMedia(e.data.writeKey,i.media);c.types.forEach(a=>{var r,n;((r=i.media.data.values[a])==null?void 0:r.type)==="remove"?e.data.species.media.values[a]=void 0:((n=i.media.data.values[a])==null?void 0:n.type)==="new"&&(e.data.species.media.values[a]=s.data.values[a])})}await this.provider.update(e),this.fakemonStore.update(s=>({...s,[e.data.readKey]:{value:e,update:this}}))}catch(s){throw te.show(s.message),s}});this.provider=e,this.fakemonStore=i}}class he{constructor(e){o(this,"upload",async(e,i)=>{const s=await fetch(e,{method:"PUT",body:i,headers:{"Content-Type":i.type,"Content-Length":i.size.toString()}});if(!s.ok)throw console.error(await s.text()),new me("Could not upload file.")});this.baseUrl=e}getAssetUrl(e){return`${this.baseUrl}/${e}`}}class me extends Error{constructor(e,i){super(e+(i!=null&&i.code?` Code: ${i.code}`:"")),this.diagnostics=i}}const pe=new he(ie);class v extends Error{constructor(e){super(e)}}class ve extends v{constructor(){super("You do not have permission to edit this pokemon.")}}class w extends l{get species(){return new S(this.data.species)}}o(w,"alphabetical",(e,i)=>e.data.species.name.localeCompare(i.data.species.name));const Q="fakemon::",T=t=>`${Q}${t}`;function $(t){const e=T(t),i=localStorage.getItem(e);if(i!=null)try{return{...JSON.parse(i),readKey:t}}catch(s){console.warn(s);return}}function ge(t){const e=$(t.readKey),i=T(t.readKey);localStorage.setItem(i,JSON.stringify({id:t.id??(e==null?void 0:e.id),writeKey:t.writeKey??(e==null?void 0:e.writeKey)}))}function _e(){const t=[];for(let e=0;e<localStorage.length;++e){const i=localStorage.key(e);if(!i.startsWith(Q))continue;const s=$(i.split("::")[1]);s!=null&&t.push(s)}return t}function fe(t){const e=T(t);localStorage.removeItem(e)}const h={get:$,add:ge,list:_e,remove:fe};class ye{constructor(e,i){o(this,"handleNewMedia",async(e,i)=>{var r;const{data:s,error:a}=await this.supabase.functions.invoke("user-assets",{method:"POST",body:{type:"fakemon-media",params:{key:e,...(r=c.forEachType(n=>{var d;return((d=i.data.values[n])==null?void 0:d.type)==="new"?{mimetype:i.data.values[n].value.type,sizeInBytes:i.data.values[n].value.size}:void 0}))==null?void 0:r.data.values}}});if(a)throw new v("Could not upload file(s) for fakemon.");return await Promise.all(c.types.map(n=>{var d;return s.values[n]!=null&&((d=i.data.values[n])==null?void 0:d.type)==="new"?this.userAssets.upload(s.values[n].uploadUrl,i.data.values[n].value):void 0}).filter(n=>n!=null)),c.forEachType(n=>{var d;return s.values[n]!=null&&((d=i.data.values[n])==null?void 0:d.type)==="new"?this.getUserAssetResource(s.values[n].filename):void 0})});o(this,"handleRemovedMedia",async(e,i)=>{const{error:s}=await this.supabase.functions.invoke("user-assets",{method:"DELETE",body:{type:"fakemon-media",params:{key:e,...c.forEachType(a=>{var r;return((r=i.data.values[a])==null?void 0:r.type)==="remove"}).data.values}}});if(s)throw new v("Could not remove file(s) for fakemon.")});o(this,"getUserAssetResource",e=>({name:e,href:this.userAssets.getAssetUrl(e)}));this.supabase=e,this.userAssets=i}async getAllKnown(){return Promise.all(h.list().map(e=>this.getByReadKey(e.readKey))).then(e=>e.filter(i=>i!=null))}async getByReadKey(e){return this.supabase.rpc("get_fakemon",{_read_key:e}).maybeSingle().then(({data:i,error:s})=>{if(this.validateError("Could not get fakemon.",s),!i)return;const a=Se(i,this.getUserAssetResource),r=h.get(e);return a.data.writeKey=r==null?void 0:r.writeKey,h.add(a.data),a})}async add(e){const{data:i,error:s}=await this.supabase.rpc("new_fakemon",this.toQuery(e)).single();this.validateError("Could not add fakemon.",s);const a={id:i.ret_id,readKey:i.ret_read_key,writeKey:i.ret_write_key};return h.add(a),new w({species:{...e,id:u.fromFakemonReadKey(a.readKey).data},...a})}async update(e){const i=e.data.writeKey;if(i==null)throw new ve;const{data:s,error:a}=await this.supabase.rpc("update_fakemon",{_write_key:i,...this.toQuery(e.data.species)}).single();return this.validateError("Could not edit fakemon.",a),s>0}async updateMedia(e,i){const[s]=await Promise.all([this.handleNewMedia(e,i),this.handleRemovedMedia(e,i)]);return s}async verifyWriteKey(e,i){const{data:s,error:a}=await this.supabase.rpc("verify_fakemon_write_key",{_id:e.data.id,_write_key:i}).single();if(a)throw new v("Could not verify fakemon.");return s>0&&h.add({id:e.data.id,readKey:e.data.readKey,writeKey:i}),s>0}validateError(e,i){if(i)throw console.error(i),new v(e)}toQuery(e){var i,s,a,r,n,d,R,z,D,F,I,j,B;return{_species_name:e.name,_type:e.type,_size:e.size,_sr:e.sr,_min_level:e.minLevel,_egg_groups:e.eggGroups,_gender:e.gender,_description:e.description,_ac:e.ac,_hp:e.hp,_hit_dice:e.hitDice,_speed_walking:e.speed.walking??0,_speed_climbing:e.speed.climbing??0,_speed_swimming:e.speed.swimming??0,_speed_flying:e.speed.flying??0,_speed_hover:e.speed.hover??0,_speed_burrowing:e.speed.burrowing??0,_sense_darkvision:e.senses.darkvision??0,_sense_blindsight:e.senses.blindsight??0,_sense_tremorsense:e.senses.tremorsense??0,_sense_truesight:e.senses.truesight??0,_strength:e.attributes.str,_dexterity:e.attributes.dex,_constitution:e.attributes.con,_intelligence:e.attributes.int,_wisdom:e.attributes.wis,_charisma:e.attributes.cha,_prof_athletics:e.skills.athletics>0,_prof_acrobatics:e.skills.acrobatics>0,_prof_sleight_of_hand:e.skills["sleight of hand"]>0,_prof_stealth:e.skills.stealth>0,_prof_arcana:e.skills.arcana>0,_prof_history:e.skills.history>0,_prof_investigation:e.skills.investigation>0,_prof_nature:e.skills.nature>0,_prof_religion:e.skills["religion fakemon"]>0,_prof_animal_handling:e.skills["animal handling"]>0,_prof_insight:e.skills.insight>0,_prof_medicine:e.skills.medicine>0,_prof_perception:e.skills.perception>0,_prof_survival:e.skills.survival>0,_prof_deception:e.skills.deception>0,_prof_intimidation:e.skills.intimidation>0,_prof_performance:e.skills.performance>0,_prof_persuasion:e.skills.persuasion>0,_save_str:e.saves.includes("str"),_save_dex:e.saves.includes("dex"),_save_con:e.saves.includes("con"),_save_int:e.saves.includes("int"),_save_wis:e.saves.includes("wis"),_save_cha:e.saves.includes("cha"),_abilities:e.abilities.normal,_hidden_abilities:e.abilities.hidden,_moves_start:e.moves.start,_moves_level2:e.moves.level2,_moves_level6:e.moves.level6,_moves_level10:e.moves.level10,_moves_level14:e.moves.level14,_moves_level18:e.moves.level18,_moves_egg:e.moves.egg,_moves_tm:e.moves.tm,_art_attribution_type:((s=(i=e.media.attribution)==null?void 0:i.portrait)==null?void 0:s.type)??null,_art_attribution_name:((r=(a=e.media.attribution)==null?void 0:a.portrait)==null?void 0:r.name)??null,_art_attribution_href:((d=(n=e.media.attribution)==null?void 0:n.portrait)==null?void 0:d.href)??null,_sprite_attribution_type:((z=(R=e.media.attribution)==null?void 0:R.sprite)==null?void 0:z.type)??null,_sprite_attribution_name:((F=(D=e.media.attribution)==null?void 0:D.sprite)==null?void 0:F.name)??null,_sprite_attribution_href:((j=(I=e.media.attribution)==null?void 0:I.sprite)==null?void 0:j.href)??null,_shiny_hue_rotation:((B=e.media.customization)==null?void 0:B.shinyHue)??0,_notes:e.notes??""}}}const be=t=>Object.entries(t).filter(([,e])=>e).map(([e])=>e);function Se(t,e){return new w({id:t.id,readKey:t.read_key,writeKey:t.write_key,species:{id:u.fromFakemonReadKey(t.read_key).data,name:t.species_name,type:t.type.filter(W.isPokeType),number:0,size:re(t.size)?t.size:"small",sr:parseFloat(t.sr),minLevel:t.min_level,eggGroups:t.egg_groups,gender:t.gender,description:t.description,ac:t.ac,hp:t.hp,hitDice:A.isHitDice(t.hit_dice)?t.hit_dice:"d6",speed:{walking:t.speed_walking,swimming:t.speed_swimming,climbing:t.speed_climbing,flying:t.speed_flying,hover:t.speed_hover,burrowing:t.speed_burrowing},senses:{darkvision:t.sense_darkvision,blindsight:t.sense_blindsight,tremorsense:t.sense_tremorsense,truesight:t.sense_truesight},attributes:{str:t.strength,dex:t.dexterity,con:t.constitution,int:t.intelligence,wis:t.wisdom,cha:t.charisma},skills:{athletics:t.prof_athletics?1:0,acrobatics:t.prof_acrobatics?1:0,"sleight of hand":t.prof_sleight_of_hand?1:0,stealth:t.prof_stealth?1:0,arcana:t.prof_arcana?1:0,history:t.prof_history?1:0,investigation:t.prof_investigation?1:0,nature:t.prof_nature?1:0,religion:t.prof_religion?1:0,"animal handling":t.prof_animal_handling?1:0,insight:t.prof_insight?1:0,medicine:t.prof_medicine?1:0,perception:t.prof_perception?1:0,survival:t.prof_survival?1:0,deception:t.prof_deception?1:0,intimidation:t.prof_intimidation?1:0,performance:t.prof_performance?1:0,persuasion:t.prof_persuasion?1:0},saves:be({str:t.save_str,dex:t.save_dex,con:t.save_con,int:t.save_int,wis:t.save_wis,cha:t.save_cha}),abilities:{normal:t.abilities,hidden:t.hidden_abilities},moves:{start:t.moves_start,level2:t.moves_level2,level6:t.moves_level6,level10:t.moves_level10,level14:t.moves_level14,level18:t.moves_level18,egg:t.moves_egg,tm:t.moves_tm},media:{values:{normalPortrait:t.normal_portrait_filename?e(t.normal_portrait_filename):void 0,normalSprite:t.normal_sprite_filename?e(t.normal_sprite_filename):void 0,shinyPortrait:t.shiny_portrait_filename?e(t.shiny_portrait_filename):void 0,shinySprite:t.shiny_sprite_filename?e(t.shiny_sprite_filename):void 0},customization:{shinyHue:t.shiny_hue_rotation},attribution:{portrait:{type:t.art_attribution_type??"",name:t.art_attribution_name??"",href:t.art_attribution_href??""},sprite:{type:t.sprite_attribution_type??"",name:t.sprite_attribution_name??"",href:t.sprite_attribution_href??""}}},notes:t.notes??""}})}const g=new ye(se,pe);function b(t,e){return{value:t,update:t.data.writeKey!=null?new ce(g,e):void 0}}function G(t,e){return{subscribe:i=>e.subscribe(s=>{i(s[t.value.data.readKey]??t)}),verifyAccess:async i=>{const s=await g.verifyWriteKey(t.value,i);return s&&e.update(a=>({...a,[t.value.data.readKey]:b(t.value.copy({writeKey:i}),e)})),s},remove:async()=>{e.update(i=>{const{[t.value.data.readKey]:s,...a}=i;return a}),h.remove(t.value.data.readKey)}}}function we(t,e){let i=!1;return{subscribe:s=>e.subscribe(a=>{s(Object.values(a).map(r=>r.value).sort(w.alphabetical)),i||(i=!0,e.update(r=>t.reduce((n,d)=>({...n,[d.data.readKey]:b(d,e)}),r)))})}}function xe(){const t=N({}),e={};let i;return{get:async s=>(e[s]==null&&(e[s]=g.getByReadKey(s).then(a=>{if(a==null)return;const r=b(a,t);return t.update(n=>({...n,[a.data.readKey]:r})),G(r,t)})),e[s]),new:async s=>g.add(s).then(a=>{const r=b(a,t),n=G(r,t);return e[a.data.readKey]=Promise.resolve(n),t.update(d=>({...d,[a.data.readKey]:r})),a}),all:async()=>(i==null&&(i=g.getAllKnown().then(s=>we(s,t))),i),reset:async()=>{t.set({})}}}const H=xe();function Ce(t,e){let i;return L(t,(s,a)=>{i!=null?s(i):e(r=>{i=r,s(r)},r=>{a(n=>{const d=r(n);return i=d,d})})})}const C=Ce(void 0,t=>{typeof window<"u"&&fetch(`${E}/pokemon/v2.json`).then(e=>e.json()).then(e=>e.items.map(i=>S.fromJson(i))).then(e=>t(e))});function Pe(){return{get:async t=>{if(t.isFakemon()){const e=await H.get(t.toFakemonReadKey());return e==null?void 0:x(e,i=>({value:i.value.species}))}else return x(C,e=>{const i=e==null?void 0:e.find(s=>s.id.data===t.data);if(i!=null)return{value:i}})},canonList:()=>C,completeList:async()=>{const t=await H.all();return x([C,t],([e,i])=>e==null?void 0:e.concat(i.map(s=>s.species)))}}}const ot=Pe(),Ke={fromType(t){switch(t.type){case"level":return new V(t.value);case"item":return new Ee(t.value);case"loyalty":return new Le(t.value);case"move":return new Ae(t.value);case"move-type":return new Te(t.value);case"gender":return new Y(t.value);case"time":return new $e(t.value);case"special":return new U(t.value);default:return new U("")}}};class V{constructor(e){this.targetLevel=e}meetsCondition(e){return e.level.data>=this.targetLevel}toString(){return`at level ${this.targetLevel} or above`}}class Ee{constructor(e){this.itemName=e}meetsCondition(){return!0}toString(){return`using a ${this.itemName}`}}class Le{constructor(e){this.targetLevel=e}meetsCondition(e){return e.bond.level>=this.targetLevel}toString(){return`with a bond of +${this.targetLevel} or higher`}}class Ae{constructor(e){this.requiredMove=e}meetsCondition(e){return e.moves.some(i=>i.moveId===this.requiredMove)}toString(){return`while knowing {{move::${this.requiredMove}}}`}}class Te{constructor(e){this.requiredType=e}meetsCondition(){return!0}toString(){return`while knowing a ${this.requiredType}-type move`}}class Y{constructor(e){this.gender=e}meetsCondition(e){return e.gender===this.gender}toString(){return`A ${this.gender}`}}class $e{constructor(e){this.time=e}meetsCondition(){return!0}toString(){return`during the ${this.time}`}}class U{constructor(e){this.condition=e}meetsCondition(){return!0}toString(){return this.condition}}const Me={fromType(t){switch(t.type){case"asi":return new Re(t.value);case"special":return new k(t.value);default:return new k("")}}};class Re{constructor(e){this.amount=e}toString(){return`its health increases by double its level, and it gains ${this.amount} points to add to its ability scores`}}class k{constructor(e){this.effect=e}toString(){return this.effect}}class M extends l{get from(){return new u(this.data.from)}get to(){return new u(this.data.to)}get conditions(){return this.data.conditions.map(e=>Ke.fromType(e))}get benefits(){return this.data.effects.map(e=>Me.fromType(e))}hasCondition(e){return this.data.conditions.some(i=>i.type===e.type&&i.value===e.value)}toString(){const e=this.conditions,i=this.benefits,s=e.find(n=>n instanceof Y),a=e.find(n=>n instanceof V),r=e.filter(n=>n!==s&&n!==a);return`${s?s.toString()+" ":""}{{pokemon:${this.data.from}}} can evolve into {{pokemon::${this.data.to}}} ${a?a.toString():""}${r.length>0&&a?" ":""}${r.map(n=>n.toString()).join(", ")}. When it evolves, ${i.map(n=>n.toString()).join(", ")}.`}static fromJson(e){return new M(e)}}class ze{constructor(e){o(this,"nodes");this.evolutions=e;const i=new Map;for(const s of e){i.has(s.data.from)||i.set(s.data.from,{id:s.from,edges:{from:[],to:[]}}),i.has(s.data.to)||i.set(s.data.to,{id:s.to,edges:{from:[],to:[]}});const a=i.get(s.data.from),r=i.get(s.data.to);a.edges.to.push(r),r.edges.from.push(a)}this.nodes=i}hasEvolutionTree(e){return this.nodes.has(e.data)}evolvesFrom(e){return this.evolutions.filter(i=>i.to.data===e.data)}evolvesTo(e){return this.evolutions.filter(i=>i.from.data===e.data)}hasCondition(e,i){return this.evolvesTo(e).some(s=>s.hasCondition(i))}currentStage(e){const i=this.nodes.get(e.data);let s=0;return i!=null&&this.dfs(i,"from",(a,r)=>{s=Math.max(s,r)}),s+1}maxStage(e){const i=this.currentStage(e),s=this.nodes.get(e.data);let a=0;return s!=null&&this.dfs(s,"to",(r,n)=>{a=Math.max(a,n)}),i+a}dfs(e,i,s,a=0){s(e,a);for(const r of e.edges[i])this.dfs(r,i,s,a+1)}}const De=L(void 0,t=>{typeof window<"u"&&fetch(`${E}/evolutions/v1.json`).then(e=>e.json()).then(e=>e.items.map(i=>M.fromJson(i))).then(e=>t(new ze(e)))});function Fe(){return{canonList:()=>De}}const dt=Fe(),X="canCreateCustomPokemonBannerVisibility",Ie=localStorage.getItem(X)==="true",je=N(Ie);je.subscribe(t=>localStorage.setItem(X,t.toString()));export{y as A,je as C,q as E,w as F,oe as G,A as H,S as P,ot as S,u as a,dt as b,nt as c,J as d,P as e,K as f,f as g,H as h,c as i,ue as j,ae as k,re as l,pe as u};
